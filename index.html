<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Marketing Cloud API Helper</title>
  <!-- Enlaza la hoja de estilos principal -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ===================================================================
     CONTENEDOR PRINCIPAL DE LA APLICACI√ìN
     Utiliza CSS Grid para definir la estructura de 3 columnas.
     =================================================================== -->
<div class="app-container">
  
  <!-- ========================================================== -->
  <!-- START: BARRA LATERAL IZQUIERDA (NAVEGACI√ìN) -->
  <!-- ========================================================== -->
  <aside id="macros-sidebar">
    
    <!-- Selector de Cliente y Estado de Sesi√≥n -->
    <div class="sidebar-client-selector">
      <h2>Cliente</h2>
      <select id="sidebarClientSelect">
        <option value="">Ninguno seleccionado</option>
      </select>
      <p id="login-status" class="login-status inactive">üî¥ Sesi√≥n no iniciada</p>
    </div>
    
    <h2>Vistas</h2>
    
    <!-- Men√∫s colapsables para agrupar las funcionalidades de la aplicaci√≥n -->
    <div class="collapsible-group">
        <h3 class="collapsible-header">General</h3>
        <ul class="collapsible-content">
          <li><a class="macro-item" data-macro="docu">Documentaci√≥n</a></li>
          <li><a class="macro-item" data-macro="configuracionAPIs">Configuraci√≥n de APIs</a></li>
        </ul>
    </div>

    <div class="collapsible-group">
        <h3 class="collapsible-header">Data Extensions</h3>
        <ul class="collapsible-content">
          <li><a class="macro-item" data-macro="configuracionDE">Configuraci√≥n de Data Extension</a></li>
          <li><a class="macro-item" data-macro="campos">Campos</a></li>
          <li><a class="macro-item" data-macro="gestionCampos">Gesti√≥n de Campos</a></li>
        </ul>
    </div>

    <div class="collapsible-group">
        <h3 class="collapsible-header">Funcionalidades</h3>
        <ul class="collapsible-content">
          <li><a class="macro-item" data-macro="calendario">Calendario</a></li>
          <li><a class="macro-item" data-macro="validadorEmail">Validador de Email</a></li>
          <li><a class="macro-item" data-macro="buscadores">Buscadores</a></li>
          <li><a class="macro-item" data-macro="gestionAutomatismos">Gesti√≥n de automatismos</a></li> 
        </ul>
    </div>
  </aside>
  <!-- END: BARRA LATERAL IZQUIERDA -->

  <!-- ========================================================== -->
  <!-- START: CONTENIDO PRINCIPAL (VISTAS) -->
  <!-- ========================================================== -->
  <main id="main-content">
    
    <!-- 1. PANTALLA DE BIENVENIDA (MEN√ö PRINCIPAL) -->
    <div id="main-menu" class="main-menu-container" style="display: flex;">
      <div class="menu-group">
        <h3>Panel Principal</h3>
        <div class="menu-buttons-container">
         <p class="info-text">
            Bienvenido a Marketing Cloud API Helper.
         </p>
         <p class="info-text">
            Para empezar, configura un cliente en "Configuraci√≥n de APIs". Al pulsar en login (o seleccion√°ndolo si ya estaba guardado) se iniciar√° el proceso de autenticaci√≥n.
         </p>
        </div>
      </div>
    </div>

    <!-- 2. SECCI√ìN: DOCUMENTACI√ìN -->
    <div id="documentacion-section" class="section">
      <div class="section-header"><button class="back-button">‚Üê Atr√°s</button></div>
      <h2>Documentaci√≥n</h2>
      <!-- Contenedor de Pesta√±as para organizar la informaci√≥n -->
      <div class="tabs-container">
        <div class="tab-buttons">
          <button class="tab-button active" data-tab="configuracion-principal">Configuraci√≥n Principal</button>
          <button class="tab-button" data-tab="guia-rapida">Gu√≠a R√°pida</button>
          <button class="tab-button" data-tab="errores-comunes">Errores Comunes</button>
          <button class="tab-button" data-tab="comentarios-adicionales">Comentarios Adicionales</button>
        </div>
        
        <!-- Pesta√±a: Configuraci√≥n Principal -->
        <div id="configuracion-principal" class="tab-content active">
          <h3>Configuraci√≥n Principal</h3>
          <ul>
            <li><strong>Configurar aplicaci√≥n en MC:</strong>
              <ul>
                <li>Entrar en Setup ‚Üí Apps ‚Üí Installed Packages.</li>
                <li>Crear un nuevo paquete de tipo <b>Server-to-Server</b> o <b>Web App</b>.</li>
                <li>Para <b>Web App</b>, configurar el callback URI como <b>https://127.0.0.1:8443/callback</b>.</li>
                <li>Asignar los siguientes permisos en el componente de la API:
                  <ul>
                    <li>Email: Read, Write</li>  
                    <li>Automations: Read, Write, Execute</li>  
                    <li>Journeys: Read</li>    
                    <li>Audiences: Read, Write</li>  
                    <li>List and Subscribers: Read, Write</li>  
                    <li>Data Extensions: Read, Write</li>              
                  </ul>
                </li>
                <li><b>IMPORTANTE:</b> Despu√©s de crear la aplicaci√≥n, puede tardar 5-10 minutos en estar plenamente operativa.</li>
              </ul>
            </li>
            <li><strong>Configurar un Cliente en la App:</strong> 
                <ul>
                  <li>Ir a <em>Configuraci√≥n de APIs</em>.</li>
                  <li>Introducir un nombre, rellenar los datos de la app de MC (MID, Auth URI, etc.) y pulsar "Guardar".</li>
                  <li>Pulsar "Login" para iniciar la sesi√≥n. Saltar√° una ventana para autenticarse en Marketing Cloud.</li>
                  <li>Si se quiere hacer uso de la b√∫squeda de env√≠os de un cliente, rellenar las External Keys de las Data Views de tracking.</li>
                </ul> 
            </li>
            <li><strong>Almacenamiento:</strong> La configuraci√≥n (sin el Client Secret) se guarda en el almacenamiento local del navegador. Las credenciales seguras (refresh token, etc.) se guardan en el gestor de credenciales del sistema operativo.</li>
            <li><strong>Gesti√≥n de Sesi√≥n:</strong> "Login" inicia la autenticaci√≥n. "Logout / Borrar" cierra la sesi√≥n activa y elimina toda la configuraci√≥n y credenciales guardadas para ese cliente.</li>
          </ul>
        </div>

        <!-- Pesta√±a: Gu√≠a R√°pida -->
        <div id="guia-rapida" class="tab-content">
          <h3>Gu√≠a R√°pida de Funcionalidades</h3>
          <ol>
              <li><b>Configuraci√≥n de DE:</b> Define nombre, descripci√≥n, carpeta y si es Sendable.</li>
              <li><b>Campos:</b> A√±ade campos manualmente, con el bot√≥n de ejemplo o importando desde el portapapeles.</li>
              <li><b>Crear DE / Campos:</b> Usa los botones "Crear Data Extension" o "Crear/Actualizar Campos" para ejecutar la acci√≥n.</li>
              <li><b>Gesti√≥n de Campos:</b> Recupera o borra campos de una DE existente. √ötil para campos en Attribute Groups que no se pueden borrar por la interfaz.</li>
              <li><b>Calendario:</b> Visualiza las automatizaciones y Journeys programados.</li>
              <li><b>Validador de Emails:</b> Valida una direcci√≥n de email contra los validadores de Marketing Cloud.</li>
              <li><b>Buscadores:</b> Busca Data Extensions, el origen de sus datos, texto en queries y suscriptores (con sus env√≠os y Journeys).</li>
              <li><b>Gesti√≥n de automatismos:</b> Permite buscar, filtrar y realizar acciones masivas (Activar, Ejecutar, Parar) sobre los automatismos.</li>
          </ol>
        </div>

        <!-- Pesta√±a: Errores Comunes -->
        <div id="errores-comunes" class="tab-content">
            <h3>Errores Comunes</h3>
            <ul>
                <li><strong>Error de autenticaci√≥n:</strong> Revisa que el MID, Client ID y Client Secret sean correctos. La URI de autenticaci√≥n debe terminar en `/v2/token`.</li>
                <li><strong>La DE se crea en la ra√≠z:</strong> Para crear una DE en una carpeta, debes usar el <strong>ID de la Carpeta</strong> (un n√∫mero), no su nombre.</li>
                <li><strong>DE Sendable sin Subscriber Key:</strong> Es <strong>obligatorio</strong> seleccionar un campo como Subscriber Key en la configuraci√≥n "Sendable".</li>
            </ul>
        </div>
        
        <!-- Pesta√±a: Comentarios Adicionales -->
        <div id="comentarios-adicionales" class="tab-content">
            <h3>Comentarios Adicionales</h3>
            <ul>
              <li><strong>Permisos:</strong> Aseg√∫rate de que la aplicaci√≥n API en MC tiene permisos de Lectura y Escritura para los objetos que quieres gestionar.</li>
              <li><strong>"Crear/Actualizar campos" es un "upsert":</strong> Esta acci√≥n actualiza campos existentes o crea nuevos si no existen en la DE.</li>
              <li><strong>Longitud en Decimales:</strong> Para campos de tipo Decimal, usa el formato "total_d√≠gitos,n√∫mero_decimales", por ejemplo, <code>18,2</code>.</li>
            </ul>
        </div>
      </div>
    </div>
    
    <!-- 3. SECCI√ìN: CONFIGURACI√ìN DE APIS -->
    <div id="configuracion-apis-section" class="section config-section-container">
         <div class="section-header">
            <button class="back-button">‚Üê Atr√°s</button>
            <div class="header-actions">
                <button id="saveConfigBtn" class="action-button">Guardar</button>
                <button id="loginBtn" class="action-button">Login</button>
                <button id="logoutBtn" class="action-button delete-btn">Logout / Borrar</button>
            </div>            
        </div>
        <h2>Configuraci√≥n de APIs</h2>
        <!-- Gesti√≥n de Clientes (Crear, Seleccionar) -->
        <div class="client-management">
            <input type="text" id="clientName" placeholder="Nombre del Cliente">
            <select id="savedConfigs">
                <option value="">Seleccionar configuraci√≥n...</option>
            </select>
        </div>
        <!-- Datos de la Aplicaci√≥n API -->
        <div class="config-block">
            <h3>Datos Aplicaci√≥n</h3>
            <div class="form-group"><label for="businessUnit">Business Unit (MID)</label><input type="text" id="businessUnit"></div>
            <div class="form-group"><label for="authUri">Auth URI</label><input type="text" id="authUri" placeholder="Ej: https://...mc.auth.marketingcloudapis.com/v2/token"></div>
            <div class="form-group"><label for="clientId">Client ID</label><input type="text" id="clientId"></div>
            <div class="form-group"><label for="clientSecret">Client Secret</label><input type="password" id="clientSecret" placeholder="Necesario para el primer login"></div>
            <div class="form-group"><label for="token">Access Token</label><input type="text" id="token" disabled></div>
            <div class="form-group"><label for="soapUri">SOAP URI</label><input type="text" id="soapUri" disabled></div>
            <div class="form-group"><label for="restUri">REST URI</label><input type="text" id="restUri" disabled></div>
            <div class="form-group"><label for="stackKey">Stack</label><input type="text" id="stackKey" disabled></div>
        </div>
        <!-- Configuraci√≥n de Data Views para el buscador de env√≠os -->
        <div class="config-block">
            <h3>Data Views</h3>
            <p class="info-text" style="text-align: left; margin: 0 0 15px;">
                Introduce la <strong>External Key completa</strong> de las Data Extensions que replican las Data Views de tracking.
            </p>
            <div class="form-group"><label for="dvSent">Sent</label><input type="text" id="dvSent" placeholder="Ej: DE_SentLog_ClienteX"></div>
            <div class="form-group"><label for="dvOpen">Open</label><input type="text" id="dvOpen" placeholder="Ej: DE_OpenLog_ClienteX"></div>
            <div class="form-group"><label for="dvClick">Click</label><input type="text" id="dvClick" placeholder="Ej: DE_ClickLog_ClienteX"></div>
            <div class="form-group"><label for="dvBounce">Bounce</label><input type="text" id="dvBounce" placeholder="Ej: DE_BounceLog_ClienteX"></div>
        </div>
    </div>

    <!-- 4. SECCI√ìN: CONFIGURACI√ìN DE DATA EXTENSION (Creaci√≥n) -->
    <div id="configuracion-de-section" class="section config-section-container">
        <div class="section-header">
            <button class="back-button">‚Üê Atr√°s</button>
            <div class="header-actions"><button id="createDE" class="action-button">Crear Data Extension</button></div>
        </div>
        <h2>Configuraci√≥n de Data Extension</h2>
        <!-- Configuraci√≥n Base de la DE -->
        <div class="config-block">
            <h3>Configuraci√≥n Base</h3>
            <div class="form-group"><label for="deName">Nombre Data Extension</label><input type="text" id="deName"></div>
            <div class="form-group"><label for="deDescription">Descripci√≥n</label><input type="text" id="deDescription"></div>
            <div class="form-group"><label for="deExternalKey">External Key</label><input type="text" id="deExternalKey" disabled></div>
            <div class="form-group"><label for="deFolder">ID de Carpeta (Opcional)</label><input type="text" id="deFolder" placeholder="Ej: 12345"></div>
        </div>
        <!-- Configuraci√≥n Sendable -->
        <div class="config-block">
            <h3>Configuraci√≥n Sendable</h3>
            <div class="form-group checkbox-group">
                <label for="isSendable">Es Sendable:</label><input type="checkbox" id="isSendable">
            </div>
            <div class="form-group">
                <label for="subscriberKeyField">Campo SubscriberKey</label>
                <select id="subscriberKeyField" disabled><option value="">-- Defina campos en la secci√≥n 'Campos' --</option></select>
            </div>
            <div class="form-group"><label for="subscriberKeyType">Tipo Campo SubscriberKey</label><input type="text" id="subscriberKeyType" disabled></div>
        </div>
    </div>

    <!-- 5. SECCI√ìN: CAMPOS DE LA DATA EXTENSION -->
    <div id="campos-section" class="section">
        <div class="section-header">
            <button class="back-button">‚Üê Atr√°s</button>
            <div class="header-actions">
                <button id="importFieldsBtn" class="action-button">Importar...</button>
                <button id="addFieldBtn" class="action-button">A√±adir Fila</button>
                <button id="createFieldsBtn" class="action-button">Crear/Actualizar Campos</button>
                <button id="createDummyFieldsBtn" class="action-button">Campos de Ejemplo</button>                
                <button id="clearFieldsBtn" class="action-button delete-btn">Limpiar Tabla</button>
            </div>
        </div>
        <h2>Campos de la Data Extension</h2>
        <div class="table-container">
          <table id="myTable">
            <thead>
              <tr><th>Campo MC</th><th>Tipo Campo</th><th>Longitud</th><th>Default</th><th>PK</th><th>Requerido</th></tr>
            </thead>
            <tbody></tbody>
          </table>
          <!-- Botones para mover filas seleccionadas -->
          <div class="control-buttons">
            <button id="moveUp" title="Mover fila seleccionada hacia arriba">Subir</button>
            <button id="moveDown" title="Mover fila seleccionada hacia abajo">Bajar</button>
          </div>
        </div>
    </div>
    
    <!-- 6. SECCI√ìN: GESTI√ìN DE CAMPOS (Recuperar/Borrar) -->
    <div id="configuracion-campos-section" class="section config-section-container">
        <div class="section-header">
            <button class="back-button">‚Üê Atr√°s</button>
            <div class="header-actions">
                <button id="getFields" class="action-button">Recuperar Campos</button>
                <button id="deleteField" class="action-button delete-btn">Borrar Campo</button>
            </div>
        </div>
        <h2>Gesti√≥n de Campos de Data Extension</h2>
        <div class="config-block">
            <h3>Par√°metros</h3>
            <p class="info-text" style="text-align: left; margin: 0 0 15px;">
                Introduce la External Key de la DE sobre la que quieres operar.
            </p>
            <div class="form-group">
                <label for="recExternalKey">External Key de la DE</label>
                <input type="text" id="recExternalKey">
            </div>
            <div class="form-group">
                <label for="targetFieldSelect">Campo a eliminar</label>
                <select id="targetFieldSelect" disabled><option value="">-- Pulsa "Recuperar Campos" --</option></select>
            </div>
        </div>
    </div>

    <!-- 7. SECCI√ìN: CALENDARIO DE AUTOMATIZACIONES -->
    <div id="calendario-section" class="section">
        <div class="section-header">
            <button class="back-button">‚Üê Atr√°s</button>
             <div class="calendar-controls">
                <label for="calendarYearSelect">A√±o:</label>
                <select id="calendarYearSelect"></select>
                <button id="refreshAutomationsBtn" class="action-button">Refrescar Automatismos</button>
                <button id="refreshJourneyAutomationsBtn" class="action-button activate-btn">Refrescar Automatismos de Journeys</button>
            </div>
        </div>
        <div class="calendar-container">
            <!-- Rejilla de meses del calendario -->
            <div id="calendar-main" class="calendar-main-view">
                <h2>Calendario de Automatizaciones</h2>
                <div id="calendar-grid" class="calendar-grid"></div>
            </div>
            <!-- Barra lateral para mostrar detalles del d√≠a seleccionado -->
            <aside id="calendar-sidebar" class="calendar-sidebar">
                <h3 id="automation-list-header">Automatizaciones del D√≠a</h3>
                <div id="automation-list">
                    <p>Selecciona un d√≠a para ver los detalles.</p>
                </div>
            </aside>
        </div>
    </div>

    <!-- 8. SECCI√ìN: VALIDADOR DE EMAIL -->
    <div id="email-validator-section" class="section config-section-container">
        <div class="section-header"><button class="back-button">‚Üê Atr√°s</button></div>
        <h2>Validador de Email</h2>
        <div class="config-block">
            <h3>Par√°metros de Validaci√≥n</h3>
            <div class="form-group">
              <label for="emailToValidate">Email a validar:</label>
              <input type="text" id="emailToValidate" placeholder="Introduce la direcci√≥n de email">
            </div>
            <div class="header-actions" style="justify-content: center; margin-top: 20px;">
               <button id="validateEmailBtn" class="action-button">Validar Email</button>
            </div>
        </div>
        <div class="config-block">
            <h3>Resultado de la Validaci√≥n</h3>
            <pre id="email-validation-results">El resultado aparecer√° aqu√≠.</pre>
        </div>
    </div>

    <!-- 9. SECCI√ìN: BUSCADORES -->
    <div id="buscadores-section" class="section">
      <div class="section-header"><button class="back-button">‚Üê Atr√°s</button></div>
      <h2>Buscadores</h2>
      <!-- Contenedor de pesta√±as para los diferentes tipos de b√∫squeda -->
      <div class="tabs-container">
        <div class="tab-buttons">
          <button class="tab-button active" data-tab="busqueda-de-tab">Data Extensions</button>
          <button class="tab-button" data-tab="origenes-tab">Origen de datos</button>
          <button class="tab-button" data-tab="clientes-tab">Clientes</button>
          <button class="tab-button" data-tab="queries-tab">Texto en Queries</button>
        </div>

        <!-- Pesta√±a: B√∫squeda de Data Extension -->
        <div id="busqueda-de-tab" class="tab-content active config-section-container">
            <div class="config-block">
                <h3>Par√°metros de B√∫squeda</h3>
                <div class="form-group">
                    <label for="deSearchProperty">Buscar por:</label>
                    <select id="deSearchProperty">
                        <option value="Name">Nombre</option>
                        <option value="CustomerKey">External Key</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="deSearchValue">Valor:</label>
                    <input type="text" id="deSearchValue" placeholder="Ingresa el valor de b√∫squeda" maxlength="128">
                </div>
                <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                    <button id="searchDEBtn" class="action-button">Buscar</button>
                </div>
            </div>
            <div class="config-block">
                <h3>Resultados</h3>
                <pre id="de-search-results">La ruta de la Data Extension aparecer√° aqu√≠.</pre>
            </div>
        </div>

        <!-- Pesta√±a: Buscador de Or√≠genes de Datos -->
        <div id="origenes-tab" class="tab-content config-section-container">
            <div class="config-block">
                <h3>Par√°metros de B√∫squeda</h3>
                <div class="form-group">
                    <label for="deNameToFind">Nombre de la Data Extension:</label>
                    <input type="text" id="deNameToFind" placeholder="Introduce el nombre exacto de la DE">
                </div>
                <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                    <button id="findDataSourcesBtn" class="action-button">Buscar Or√≠genes</button>
                </div>
            </div>
            <div class="config-block" style="flex-grow: 1;">
                <h3>Actividades Encontradas</h3>
                <div class="table-container">
                    <table id="data-sources-table">
                        <thead>
                            <tr>
                                <th>Actividad</th><th>Tipo</th><th>Automatizaci√≥n</th>
                                <th>Paso</th><th>Acci√≥n</th><th>Descripci√≥n / Query</th>
                            </tr>
                        </thead>
                        <tbody id="data-sources-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Pesta√±a: Buscador de Clientes (Suscriptores) -->
        <div id="clientes-tab" class="tab-content config-section-container">
            <div class="config-block">
                <h3>Par√°metros de B√∫squeda</h3>
                <div class="form-group">
                    <label for="customerSearchValue">Buscar por Subscriber Key o Email:</label>
                    <input type="text" id="customerSearchValue" placeholder="Ingresa el valor a buscar">
                </div>
                <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                    <button id="searchCustomerBtn" class="action-button">Buscar Cliente</button>
                </div>
            </div>
            <!-- Bloque de Resultados de la B√∫squeda -->
            <div class="config-block" style="flex-grow: 1;">
                <div class="config-block-header">
                    <h3>Resultados</h3>
                    <div class="header-actions">
                        <button id="getCustomerSendsBtn" class="action-button" disabled>Env√≠os</button>
                        <button id="getCustomerJourneysBtn" class="action-button" disabled>Journeys</button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="customer-search-table">
                        <thead>
                            <tr>
                                <th>Subscriber Key</th><th>Email</th><th>Estado</th>
                                <th>Fecha Creaci√≥n</th><th>Fecha Baja</th><th>Es Suscriptor</th>
                            </tr>
                        </thead>
                        <tbody id="customer-search-tbody"></tbody>
                    </table>
                </div>
            </div>
            <!-- Bloque de Resultados de Journeys (oculto por defecto) -->
            <div id="customer-journeys-results-block" class="config-block hidden">
                <h3>Journeys del Cliente Seleccionado</h3>
                <div class="table-container">
                    <table id="customer-journeys-table">
                        <thead>
                            <tr>
                                <th>Nombre del Journey</th><th>ID</th><th>Definition Key</th>
                                <th>Versi√≥n</th><th>Fecha Creaci√≥n</th><th>Fecha Modificaci√≥n</th>
                            </tr>
                        </thead>
                        <tbody id="customer-journeys-tbody"></tbody>
                    </table>
                </div>
            </div>
            <!-- Bloque de Resultados de Env√≠os (oculto por defecto) -->
            <div id="customer-sends-results-block" class="config-block hidden">
                <h3>Env√≠os del Cliente Seleccionado</h3>
                <div class="sends-dataview-block">
                    <h4>Enviados (Sent)</h4>
                    <div id="sends-table-container" class="table-container"></div>
                </div>
                <div class="sends-dataview-block">
                    <h4>Aperturas (Open)</h4>
                    <div id="opens-table-container" class="table-container"></div>
                </div>
                <div class="sends-dataview-block">
                    <h4>Clics (Click)</h4>
                    <div id="clicks-table-container" class="table-container"></div>
                </div>
                <div class="sends-dataview-block">
                    <h4>Rebotes (Bounce)</h4>
                    <div id="bounces-table-container" class="table-container"></div>
                </div>
            </div>
        </div>

        <!-- Pesta√±a: Buscador de Texto en Queries -->
        <div id="queries-tab" class="tab-content config-section-container">
            <div class="config-block">
                <h3>Par√°metros de B√∫squeda</h3>
                <div class="form-group">
                    <label for="querySearchText">Texto a buscar en la Query:</label>
                    <input type="text" id="querySearchText" placeholder="Ej: _Subscribers o Nombre_DE">
                </div>
                <div class="form-group checkbox-group" style="justify-content: flex-start;">
                    <label for="showQueryTextCheckbox">Mostrar Query Text:</label>
                    <input type="checkbox" id="showQueryTextCheckbox" checked>
                </div>
                <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                    <button id="searchQueriesByTextBtn" class="action-button">Buscar en Queries</button>
                </div>
            </div>
            <div class="config-block" style="flex-grow: 1;">
                <h3>Queries Encontradas</h3>
                <div class="table-container">
                    <table id="query-search-results-table">
                        <thead>
                            <tr>
                                <th>Nombre de la Query</th><th>Automatizaci√≥n</th>
                                <th>Paso</th><th>Query Text</th>
                            </tr>
                        </thead>
                        <tbody id="query-search-results-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>
      </div>
    </div>
    
    <!-- 10. SECCI√ìN: GESTI√ìN DE AUTOMATISMOS -->
    <div id="gestion-automatismos-section" class="section">
        <div class="section-header">
            <button class="back-button">‚Üê Atr√°s</button>            
            <div class="header-actions">
                <button id="refreshAutomationsTableBtn" class="action-button">Refrescar</button>
                <button id="activateAutomationBtn" class="action-button activate-btn" disabled>Activar</button>
                <button id="runAutomationBtn" class="action-button" disabled>Ejecutar</button>
                <button id="stopAutomationBtn" class="action-button delete-btn" disabled>Parar</button>
            </div>
        </div>
        <h2>Gesti√≥n de Automatismos</h2>
        <!-- Filtros para la tabla de automatismos -->
        <div class="header-filters">
            <input type="text" id="automationNameFilter" class="filter-input" placeholder="Buscar por nombre...">
            <select id="automationStatusFilter" class="filter-input">
                <option value="">Todos los estados</option>
            </select>
        </div>
        <div class="table-container">
          <table id="automations-table">
            <thead>
              <tr>
                <th class="sortable-header" data-sort-by="name">Nombre</th>
                <th class="sortable-header" data-sort-by="lastRunTime">√öltima Ejecuci√≥n</th>
                <th class="sortable-header" data-sort-by="schedule.scheduledTime">Pr√≥xima Ejecuci√≥n</th>
                <th class="sortable-header" data-sort-by="status">Estado</th>
              </tr>
            </thead>
            <tbody id="automations-tbody"></tbody>
          </table>
        </div>
    </div>
    
  </main> 
  <!-- END: CONTENIDO PRINCIPAL -->

  <!-- ========================================================== -->
  <!-- START: BARRA LATERAL DERECHA (LOG) -->
  <!-- ========================================================== -->
  <aside id="log-sidebar">
    <div class="log-header">
      <h2>Log de Eventos</h2>
      <button id="toggleLogBtn" title="Colapsar/Expandir Log"></button>
    </div>
    <!-- Bloque para mensajes de estado de la aplicaci√≥n -->
    <div id="log-message-block" class="log-block">
      <h4>Mensajes</h4>
      <pre><code id="log-messages">Esperando acciones...</code></pre>
    </div>
    <!-- Bloque para mostrar el cuerpo de las peticiones API -->
    <div id="log-request-block" class="log-block">
      <h4>Llamada API</h4>
      <pre><code id="log-request"></code></pre>
    </div>
    <!-- Bloque para mostrar el cuerpo de las respuestas API -->
    <div id="log-response-block" class="log-block">
      <h4>Respuesta API</h4>
      <pre><code id="log-response"></code></pre>
    </div>
  </aside>
  <!-- END: BARRA LATERAL DERECHA -->

</div>
<!-- END: CONTENEDOR PRINCIPAL -->

<!-- ========================================================== -->
<!-- START: MODAL DE IMPORTACI√ìN DE CAMPOS -->
<!-- ========================================================== -->
<div id="import-modal" class="modal-overlay">
    <div class="modal-content">
        <h3>Importar Campos desde Portapapeles</h3>
        <p>Pega aqu√≠ los datos. Las columnas deben ser: <b>Nombre</b>, <b>Tipo</b> y <b>Longitud</b> (opcional).</p>
        <div class="delimiter-selector">
            <label for="delimiter-select">Separador:</label>
            <select id="delimiter-select">
                <option value="tab" selected>Tabulador (Excel)</option>
                <option value="comma">Coma (,)</option>
                <option value="semicolon">Punto y coma (;)</option>
                <option value="other">Otro...</option>
            </select>
            <input type="text" id="custom-delimiter-input" class="hidden" maxlength="1" placeholder="|">
        </div>
        <textarea id="paste-data-area" rows="10" placeholder="Ciudad	Text	50&#10;Email	EmailAddress	254"></textarea>
        <div class="modal-actions">
            <button id="process-paste-btn" class="action-button">A√±adir Campos</button>
            <button id="cancel-paste-btn" class="action-button delete-btn">Cancelar</button>
        </div>
    </div>
</div>
<!-- END: MODAL DE IMPORTACI√ìN -->

<!-- Enlaza el fichero JavaScript al final del body para un rendimiento √≥ptimo -->
<script src="ui.js"></script>
</body>
</html>