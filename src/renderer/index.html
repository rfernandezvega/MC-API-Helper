<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Marketing Cloud API Helper</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self'; connect-src 'self' https://*.marketingcloudapis.com https://*.exacttarget.com https://www.googleapis.com">
  <!-- Enlaza la hoja de estilos principal -->
  <link rel="stylesheet" href="styles/style.css">
</head>
<body>

<!-- ========================================================== -->
<!-- START: MODALES Y OVERLAYS GLOBALES -->
<!-- ========================================================== -->
<div id="license-modal-overlay" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <h3>Acceso a la Aplicaci√≥n</h3>
        <!-- Este p√°rrafo ser√° actualizado por el script para mostrar el estado -->
        <p id="license-status-message">Verificando licencia de usuario...</p>
    </div>
</div>
<div id="loader-overlay" class="loader-overlay" style="display: none;">
    <div class="loader-spinner"></div>
    <p id="loader-text" class="loader-text">Cargando...</p>
</div>

<!-- ===================================================================
     CONTENEDOR PRINCIPAL DE LA APLICACI√ìN
     =================================================================== -->
<div class="app-container">
  
  <!-- ========================================================== -->
  <!-- BARRA LATERAL IZQUIERDA (NAVEGACI√ìN) -->
  <!-- ========================================================== -->
  <aside id="macros-sidebar">
    <!-- Selector de Cliente y Estado de Sesi√≥n -->
    <div class="sidebar-client-selector">
      <h2>Cliente</h2>
      <select id="sidebarClientSelect">
        <option value="">Ninguno seleccionado</option>
      </select>
      <p id="login-status" class="login-status inactive">üî¥ Sesi√≥n no iniciada</p>
    </div>
    <h2>Vistas</h2>
    <!-- Men√∫s colapsables -->
    <div class="collapsible-group">
        <h3 class="collapsible-header">General</h3>
        <ul class="collapsible-content">
          <li><a class="macro-item" data-macro="docu">Documentaci√≥n</a></li>
          <li><a class="macro-item" data-macro="configuracionAPIs">Configuraci√≥n de APIs</a></li>
        </ul>
    </div>
    <div class="collapsible-group">
        <h3 class="collapsible-header">Data Extensions</h3>
        <ul class="collapsible-content">
          <li><a class="macro-item" data-macro="configuracionDE">Creaci√≥n de Data Extension</a></li>
          <li><a class="macro-item" data-macro="campos">Configuraci√≥n de Campos</a></li>
          <li><a class="macro-item" data-macro="gestionCampos">Recuperaci√≥n y Borrado de Campos</a></li>
        </ul>
    </div>
    <div class="collapsible-group">
        <h3 class="collapsible-header">Funcionalidades</h3>
        <ul class="collapsible-content">
          <li><a class="macro-item" data-macro="buscadores">Buscadores</a></li>
          <li><a class="macro-item" data-macro="calendario">Calendario</a></li>         
          <li><a class="macro-item" data-macro="gestionAutomatismos">Gesti√≥n de automatismos</a></li> 
          <li><a class="macro-item" data-macro="clonadorQueries">Clonador de Queries</a></li>
          <li><a class="macro-item" data-macro="gestionJourneys">Gesti√≥n de Journeys</a></li>          
          <li><a class="macro-item" data-macro="gestionCloudPages">Gesti√≥n de Cloud Pages</a></li>  
          <li><a class="macro-item" data-macro="validadorEmail">Validador de Email</a></li>
        </ul>
    </div>
  </aside>

  <!-- ========================================================== -->
  <!-- CONTENIDO PRINCIPAL (VAC√çO) -->
  <!-- ========================================================== -->
  <main id="main-content">   
    <!-- 
      Este es el marcador de inyecci√≥n.
      El script 'build-html.js' leer√° todos los ficheros de la carpeta /views
      y pegar√° su contenido aqu√≠ para construir el 'index.html' final.
    -->
    <!-- 3. SECCI√ìN: CONFIGURACI√ìN DE APIS -->
<div id="configuracion-apis-section" class="section config-section-container">
        <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>
        <div class="header-actions">
            <button id="saveConfigBtn" class="action-button">Guardar</button>
            <button id="loginBtn" class="action-button">Login</button>
            <button id="logoutBtn" class="action-button delete-btn">Logout / Borrar</button>
        </div>            
    </div>
    <h2>Configuraci√≥n de APIs</h2>
    <!-- Gesti√≥n de Clientes (Crear, Seleccionar) -->
    <div class="client-management">
        <input type="text" id="clientName" placeholder="Nombre del Cliente">
        <select id="savedConfigs">
            <option value="">Seleccionar configuraci√≥n...</option>
        </select>
    </div>
    <!-- Datos de la Aplicaci√≥n API -->
    <div class="config-block">
        <h3>Datos Aplicaci√≥n</h3>
        <div class="form-group"><label for="businessUnit">Business Unit (MID)</label><input type="text" id="businessUnit"></div>
        <div class="form-group"><label for="authUri">Auth URI</label><input type="text" id="authUri" placeholder="Ej: https://...mc.auth.marketingcloudapis.com/v2/token"></div>
        <div class="form-group"><label for="clientId">Client ID</label><input type="text" id="clientId"></div>
        <div class="form-group"><label for="clientSecret">Client Secret</label><input type="password" id="clientSecret" placeholder="Necesario para el primer login"></div>
        <div class="form-group"><label for="token">Access Token</label><input type="text" id="token" disabled></div>
        <div class="form-group"><label for="soapUri">SOAP URI</label><input type="text" id="soapUri" disabled></div>
        <div class="form-group"><label for="restUri">REST URI</label><input type="text" id="restUri" disabled></div>
        <div class="form-group"><label for="stackKey">Stack</label><input type="text" id="stackKey" disabled></div>
    </div>
    <!-- Configuraci√≥n de Data Views para el buscador de env√≠os -->
    <div class="config-block">
        <h3>B√∫squeda Din√°mica en Data Extensions</h3>
        <p class="info-text" style="text-align: left; margin: 0 0 15px;">
            Configura las tablas donde se buscar√° al cliente al pulsar el bot√≥n "DEs". Los cambios se guardan junto con el resto de la configuraci√≥n.
        </p>
        <div class="table-container">
            <table id="sends-config-table" class="editable-row-table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>External Key</th>
                        <th>Campo de B√∫squeda</th>
                    </tr>
                </thead>
                <tbody id="sends-config-tbody">
                    <!-- Las filas se a√±adir√°n/cargar√°n din√°micamente aqu√≠ -->
                </tbody>
            </table>
        </div>
        <div class="header-actions" style="justify-content: flex-start; margin-top: 15px;">
            <button id="add-send-config-row-btn" class="action-button">A√±adir Fila</button>
        </div>
    </div>
</div>

<!-- 15. SECCI√ìN: CLONADOR DE AUTOMATISMOS -->
<div id="automation-cloner-section" class="section">
    <div class="section-header">
        <!-- El bot√≥n "Atr√°s" ser√° gestionado por la l√≥gica para volver a la tabla de automatismos -->
        <button id="automationClonerBackBtn" class="back-button">‚Üê Volver a la lista</button>            
        <div class="header-actions">
            <!-- Este bot√≥n estar√° deshabilitado hasta que implementemos el siguiente paso -->
            <button id="automationClonerContinueBtn" class="action-button activate-btn" disabled>Clonar</button>
        </div>
    </div>
    <h2>Clonador Selectivo de Automatismo</h2>

    <!-- Contenedor principal que se rellenar√° din√°micamente -->
    <div class="config-section-container">
        <div class="config-block">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Automatismo Origen</th>
                            <th>Automatismo Destino (Editable)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td id="automationClonerSourceName">Cargando...</td>
                            <td id="automationClonerDestName" contenteditable="true"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="config-block">
            <h3>Selecciona las actividades a clonar:</h3>
            <!-- Aqu√≠ se insertar√°n din√°micamente los pasos y sus tablas -->
            <div id="automationClonerStepsContainer">
                <!-- Ejemplo de c√≥mo se ver√° un paso (se genera con JS) -->
                <!-- 
                <div class="step-block">
                    <h4>Paso 1</h4>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 5%;"><input type="checkbox" class="select-all-step-activities"></th>
                                    <th>Tipo</th>
                                    <th>Nombre Origen</th>
                                    <th>Nombre Destino (Editable)</th>
                                    <th>Nombre DE Destino (Editable)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><input type="checkbox"></td>
                                    <td>Query Activit</td>
                                    <td>Test</td>
                                    <td>Test_Copy</td>
                                    <td>Test_Copy</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div> 
                -->
            </div>
        </div>
    </div>
</div>

<!-- 10. SECCI√ìN: GESTI√ìN DE AUTOMATISMOS -->
<div id="gestion-automatismos-section" class="section">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>            
        <div class="header-actions">
            <button id="refreshAutomationsTableBtn" class="action-button">Refrescar</button>
            <button id="activateAutomationBtn" class="action-button activate-btn" disabled>Activar</button>
            <button id="runAutomationBtn" class="action-button" disabled>Ejecutar</button>
            <button id="stopAutomationBtn" class="action-button delete-btn" disabled>Parar</button>
            <button id="cloneAutomationBtn" class="action-button" disabled>Clonar</button>
        </div>
    </div>
    <h2>Gesti√≥n de Automatismos</h2>
    <!-- Filtros para la tabla de automatismos -->
    <div class="header-filters">
        <input type="text" id="automationNameFilter" class="filter-input" placeholder="Buscar por nombre...">
        <select id="automationStatusFilter" class="filter-input">
            <option value="">Todos los estados</option>
        </select>
    </div>
    <div class="table-container">
        <table id="automations-table">
        <thead>
            <tr>
            <th class="sortable-header" data-sort-by="name">Nombre</th>
            <th class="sortable-header" data-sort-by="lastRunTime">√öltima Ejecuci√≥n</th>
            <th class="sortable-header" data-sort-by="schedule.scheduledTime">Pr√≥xima Ejecuci√≥n</th>
            <th class="sortable-header" data-sort-by="status">Estado</th>
            </tr>
        </thead>
        <tbody id="automations-tbody"></tbody>
        </table>
    </div>
        <div id="pagination-automations" class="pagination-controls">
        <button id="prevPageBtnAutomations" class="action-button pagination-arrow">&laquo;</button>
        <input type="number" id="pageInputAutomations" class="filter-input page-input" min="1">
        <span id="totalPagesAutomations">/ 1</span>
        <button id="nextPageBtnAutomations" class="action-button pagination-arrow">&raquo;</button>
        </div>
</div>

<!-- 7. SECCI√ìN: CALENDARIO DE AUTOMATIZACIONES -->
<div id="calendario-section" class="section">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>
            <div class="calendar-controls">
            <label for="calendarYearSelect">A√±o:</label>
            <select id="calendarYearSelect"></select>
            <button id="refreshAutomationsBtn" class="action-button">Refrescar Automatismos</button>
            <button id="refreshJourneyAutomationsBtn" class="action-button activate-btn">Refrescar Automatismos de Journeys</button>
        </div>
    </div>
    <div class="calendar-container">
        <!-- Rejilla de meses del calendario -->
        <div id="calendar-main" class="calendar-main-view">
            <h2>Calendario de Automatizaciones</h2>
            <div id="calendar-grid" class="calendar-grid"></div>
        </div>
        <!-- Barra lateral para mostrar detalles del d√≠a seleccionado -->
        <aside id="calendar-sidebar" class="calendar-sidebar">
            <h3 id="automation-list-header">Automatizaciones del D√≠a</h3>
            <div id="automation-list">
                <p>Selecciona un d√≠a para ver los detalles.</p>
            </div>
        </aside>
    </div>
</div>

 <!-- 13. SECCI√ìN: GESTI√ìN DE CLOUD PAGES -->
<div id="gestion-cloudpages-section" class="section">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>  
        <div class="header-actions">
            <button id="refreshCloudPagesTableBtn" class="action-button">Refrescar</button>
        </div>          
    </div>
    <h2>Gesti√≥n de Cloud Pages</h2>
    <!-- Filtros para la tabla -->
    <div class="header-filters">
        <input type="text" id="cloudPageNameFilter" class="filter-input" placeholder="Buscar por nombre...">
        <select id="cloudPageTypeFilter" class="filter-input">
            <option value="">Todos los tipos</option>
            <!-- Opciones se cargar√°n din√°micamente -->
        </select>
    </div>
    <div class="table-container">
      <table id="cloudpages-table">
        <thead>
          <tr>
            <th class="sortable-header" data-sort-by="name">Nombre</th>
            <th class="sortable-header" data-sort-by="assetType.displayName">Tipo</th>
            <th class="sortable-header" data-sort-by="modifiedDate">Fecha Modificaci√≥n</th>
            <th class="sortable-header" data-sort-by="location">Ubicaci√≥n</th>
            <th class="sortable-header" data-sort-by="url">URL</th>
          </tr>
        </thead>
        <tbody id="cloudpages-tbody"></tbody>
      </table>
    </div>
     <div id="pagination-cloudpages" class="pagination-controls">
      <button id="prevPageBtnCloudPages" class="action-button pagination-arrow">&laquo;</button>
      <input type="number" id="pageInputCloudPages" class="filter-input page-input" min="1">
      <span id="totalPagesCloudPages">/ 1</span>
      <button id="nextPageBtnCloudPages" class="action-button pagination-arrow">&raquo;</button>
    </div>
</div>

<!-- 4. SECCI√ìN: CONFIGURACI√ìN DE DATA EXTENSION (Creaci√≥n) -->
<div id="configuracion-de-section" class="section config-section-container">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>
        <div class="header-actions"><button id="createDE" class="action-button">Crear Data Extension</button></div>
    </div>
    <h2>Configuraci√≥n de Data Extension</h2>
    <!-- Configuraci√≥n Base de la DE -->
    <div class="config-block">
        <h3>Configuraci√≥n Base</h3>
        <div class="form-group"><label for="deName">Nombre Data Extension</label><input type="text" id="deName"></div>
        <div class="form-group"><label for="deDescription">Descripci√≥n</label><input type="text" id="deDescription"></div>
        <div class="form-group"><label for="deExternalKey">External Key</label><input type="text" id="deExternalKey" disabled></div>
        <div class="form-group"><label for="deFolder">ID de Carpeta (Opcional)</label><input type="text" id="deFolder" placeholder="Ej: 12345"></div>
    </div>
    <!-- Configuraci√≥n Sendable -->
    <div class="config-block">
        <h3>Configuraci√≥n Sendable</h3>
        <div class="form-group checkbox-group">
            <label for="isSendable">Es Sendable:</label><input type="checkbox" id="isSendable">
        </div>
        <div class="form-group">
            <label for="subscriberKeyField">Campo SubscriberKey</label>
            <select id="subscriberKeyField" disabled><option value="">-- Defina campos en la secci√≥n 'Campos' --</option></select>
        </div>
        <div class="form-group"><label for="subscriberKeyType">Tipo Campo SubscriberKey</label><input type="text" id="subscriberKeyType" disabled></div>
    </div>
</div>

<!-- 2. SECCI√ìN: DOCUMENTACI√ìN -->
    <div id="documentacion-section" class="section">
      <div class="section-header"><button class="back-button">‚Üê Atr√°s</button></div>
      <h2>Documentaci√≥n y Gu√≠a de Uso</h2>
      
      <div class="tabs-container docu-container">
        <div class="tab-buttons">
          <button class="tab-button active" data-tab="configuracion-principal">Primeros Pasos</button>
          <button class="tab-button" data-tab="guia-rapida">Gu√≠a de funcionalidades</button>
          <button class="tab-button" data-tab="errores-comunes">Errores Comunes</button>
          <button class="tab-button" data-tab="comentarios-adicionales">Comentarios</button>
        </div>
        
        <!-- Pesta√±a: Primeros Pasos -->
        <div id="configuracion-principal" class="tab-content active">
          <ol class="docu-accordion">

            <!-- Paso 1 -->
            <li class="docu-accordion-item">
              <div class="docu-accordion-header">
                <span>
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 8px;"><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" /></svg>
                  <strong>Paso 1: Configurar la Aplicaci√≥n en Marketing Cloud</strong>
                </span>
              </div>
              <div class="docu-accordion-content">
                <div class="docu-list">
                  <ul>
                    <li>Ve a <b>Setup ‚Üí Apps ‚Üí Installed Packages</b>.</li>
                    <li>Crea un nuevo paquete de tipo <b>Web App</b> llamado <b>MC API Helper</b>.</li>
                    <li>El **Redirect URI** debe ser exactamente: <code>https://127.0.0.1:8443/callback</code>.</li>
                    <li>En el componente de API, asigna estos permisos:
                      <ul class="docu-permissions">
                        <li><b>Email:</b> Read, Write</li>
                        <li><b>Automations:</b> Read, Write, Execute</li>
                        <li><b>Journeys:</b> Read, Write, Activate/Stop/Pause/Resume/Send/Schedule, Delete</li>
                        <li><b>Audiences:</b> Read, Write</li>
                        <li><b>List and Subscribers:</b> Read, Write</li>
                        <li><b>Data Extensions:</b> Read, Write</li>
                        <li><b>Documents and Images:</b> Read</li>
                        <li><b>Saved Content:</b> Read</li>
                      </ul>
                    </li>
                    <div class="docu-callout info">
                      <b>IMPORTANTE:</b> La aplicaci√≥n en Marketing Cloud puede tardar hasta 10 minutos en estar completamente operativa despu√©s de guardarla.
                    </div>
                  </ul>
                </div>
              </div>
            </li>

            <!-- Paso 2 -->
            <li class="docu-accordion-item">
              <div class="docu-accordion-header">
                <span>
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 8px;"><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M9 7h1" /><path d="M9 13h6" /><path d="M9 17h6" /></svg>
                  <strong>Paso 2: Configurar un Cliente en esta App</strong>
                </span>
              </div>
              <div class="docu-accordion-content">
                <div class="docu-list">
                  <ul>
                    <li>Ve a la vista de <b>Configuraci√≥n de APIs</b>.</li>
                    <li>Introduce un nombre para el cliente (ej: "Cliente X - Producci√≥n").</li>
                    <li>Rellena los datos (MID, Auth URI, Client ID, etc.) obtenidos del paso anterior.</li>
                    <li>Pulsa <b>"Login"</b> para guardar e iniciar la sesi√≥n. Se abrir√° una ventana de Salesforce para que te autentiques.</li>
                    <li>En la parte inferior se pueden configurar las tablas sobre las que lanzar la b√∫squeda de clientes. Se debe indicar el nombre de la tabla, su External Key y el nombre del campo por el que buscar al cliente</li>
                    <li>Pulsa <b>"Guardar"</b>. La configuraci√≥n quedar√° almacenada en tu equipo. Esto principalmente es para la parte de las tablas.</li>
                  </ul>
                </div>
              </div>
            </li>

             <!-- Paso 3 -->
            <li class="docu-accordion-item">
              <div class="docu-accordion-header">
                <span>
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 8px;"><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M9 7h1" /><path d="M9 13h6" /><path d="M9 17h6" /></svg>
                  <strong>Log de Eventos</strong>
                </span>
              </div>
              <div class="docu-accordion-content">
                <div class="docu-list">
                  <ul>
                    <li>El panel lateral derecho se puede colapsar.</li>
                    <li>El bloque <b>Mensajes</b> muestra los procesos ejecutados y los posibles errores que se hayan podido dar al realizar una acci√≥n.</li>
                    <li>El bloque <b>Llamada API</b>, muestra todas las llamadas que se han hecho al realizar una acci√≥n con el endpoint y el payload.</li>
                    <li>El bloque <b>Respuesta API</b>Respuesta API, muestra todas las respuestas que se han recibido al realizar una acci√≥n.</li>
                  </ul>
                </div>
              </div>
            </li>

          </ol>
        </div>

        <!-- Pesta√±a: Gu√≠a R√°pida (Versi√≥n Acorde√≥n) -->
        <div id="guia-rapida" class="tab-content">
          <ol class="docu-accordion">

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
            <span>Creaci√≥n de Data Extensions</span>
            </div>
            <div class="docu-accordion-content">
            <div class="docu-list"> <!-- Envolvemos en .docu-list para mantener estilos -->
              <p>Este flujo te permite crear una Data Extensions.</p>
              <ol>
              <li><b>Configuraci√≥n:</b>
                <ul>
                <li>Ve a <b>Data Extensions ‚Üí Creaci√≥n de Data Extension</b> para definir el Nombre, la Descripci√≥n y si es "Sendable".</li>
                <li>Puedes incluir el identificador de una carpeta para que se cree donde quieras. Si no se indica, se crea en la carpeta <b>Data Extensions</b>.</li>
                <li>Ve a <b>Data Extensions ‚Üí Configuraci√≥n de Campos</b> para a√±adir los campos.</li> 
                <li>Puedes hacerlo con:
                  <ul style="margin-top: 10px;">	
                      <li><b>A√±adir Fila:</b> A√±ade filas para configurar campos manualmente. Puedes elminar la fila seleccionandola y pulsando en el bot√≥n que aparece a la derecha.</li>	
                      <li><b>Campos de Ejemplo:</b> Mete un campo de cada tipo</li>							
                      <li><b>Importar:</b> Permite pegar desde el portapapeles, indicando que separador utilizar.</li>							
                    </ul>                
                </li>
                <li>Finalmente, pulsa <b>"Crear Data Extension"</b> en la primera pantalla.</li>
                </ul>
              </li>
            </div>
            </div>
          </li>
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
            <span>Modificar o A√±adir Campos a una DE Existente</span>
            </div>
            <div class="docu-accordion-content">
            <div class="docu-list"> <!-- Envolvemos en .docu-list para mantener estilos -->
              <p>Este flujo te permite crear o actualizar campos en una Data Extension.</p>
              <ol>            
              <li><b>Configuraci√≥n:</b>
                <ul>
                <li>Ve a <b>Data Extensions ‚Üí Recuperaci√≥n y Borrado de Campos</b>.</li>
                <li>Introduce la <b>External Key</b> de la DE y pulsa <b>"Recuperar Campos"</b>.</li>
                <li>La estructura se cargar√° en la vista de <b>Configuraci√≥n de Campos</b>. A√±ade las filas nuevas que necesites.</li>
                <li>Pulsa <b>"Crear/Actualizar Campos"</b> para aplicar los cambios (esta acci√≥n no borra campos).</li>
                </ul>
              </li>
              </ol>
            </div>
            </div>
          </li>

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
            <span>Borrar campos a una DE Existente</span>
            </div>
            <div class="docu-accordion-content">
            <div class="docu-list"> <!-- Envolvemos en .docu-list para mantener estilos -->
              <p>Este flujo te permite borrar un campo en una Data Extension. Esto no se puede hacer por pantalla si est√° en un grupo de atributos, pero s√≠ por API</p>
              <ol>    
              <li><b>Configuraci√≥n:</b>
                <ul>
                  <li>En la misma vista de <b>Recuperaci√≥n y Borrado de Campos</b>, introduce la <b>External Key</b> de la DE y pulsa <b>"Recuperar Campos"</b></li>
                  <li>La estructura se cargar√° en la vista de <b>Configuraci√≥n de Campos</b> y en la <b>picklist</b>.</li>
                  <li>Selecciona un campo en la picklist y pulsa <b>"Borrar Campo"</b> para eliminarlo.</li>
                </ul>
              </li>
              </ol>
            </div>
            </div>
          </li>

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
            <span>Documentar Data Extensions</span>
            </div>
            <div class="docu-accordion-content">
            <div class="docu-list"> <!-- Envolvemos en .docu-list para mantener estilos -->
              <p>Este flujo te permite generar un csv con las Data Extensions de una carpeta. Util cuando hay que reivsar una nueva instancia</p>
              <ol>    
              <li><b>Configuraci√≥n:</b>
                <ul>
                  <li>En la misma vista de <b>Recuperaci√≥n y Borrado de Campos</b>, introduce el <b>ID num√©rico</b> de una carpeta.</li>
                  <li>Pulsa <b>"Documentar Data Extensions"</b>. La aplicaci√≥n generar√° y descargar√° un fichero CSV con todas las DEs de esa carpeta y la estructura completa de sus campos.</li>
                </ul>
              </li>
              </ol>
            </div>
            </div>
          </li>

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
            <span>Calendario de Automatizaciones</span>
            </div>
            <div class="docu-accordion-content">
            <div class="docu-list">
              <p>Una vista para visualizar los automatismos programados o los automatismos programados que lanzan journeys.</p>
              <ul>
                <li><b>Refrescar Automatismos:</b> Pulsa este bot√≥n para cargar <b>todas</b> las automatizaciones programadas en el calendario.</li>
                <li><b>Refrescar Automatismos de Journeys:</b> Pulsa este bot√≥n para cargar √∫nicamente las automatizaciones que contienen una actividad de Journey.</li>
                <li><b>Navegaci√≥n:</b> Haz clic en un d√≠a del calendario que est√© resaltado. La lista de la derecha se actualizar√° con las ejecuciones de ese d√≠a. Si haces clic en el t√≠tulo de esa lista <b>"Automatizaciones del D√≠a"</b>, ser√°s redirigido a la vista de  <b>"Gesti√≥n de Automatismos"</b>, pre-filtrada para mostrar solo las de ese d√≠a.</li>
              </ul>
            </div>
            </div>
          </li>
          
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Gesti√≥n de Automatismos</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control para visualizar, filtrar y ejecutar acciones sobre m√∫ltiples automatismos a la vez.</p>
                <ul>
                  <li>Al entrar por primera vez, se recuperar√°n y cargar√°n todos los automatismos de la instancia</li>
                  <li>Es posible filtrar por <b>Nombre</b> y <b>Estado</b> de los automatismos</li>
                  <li>La tabla permite seleccionar m√°s de un automatismo. Volviendo a clicar, se deselecciona.</li>
                  <li><b>Lanzar acciones.</b> Si se selecciona m√°s de un automatismo, solo se pueden lanzar acciones si todos los automatismos seleccionados tienen el <b>mismo estado</b>.						
                    <ul style="margin-top: 10px;">	
                      <li><b>Refrescar:</b> Refresca el listado completo de automatismos. Esto se hace autom√°ticamente al realizar cualquier acci√≥n.</li>	
                      <li><b>Activar:</b> Pone en marcha la programaci√≥n de los automatismos seleccionados. Solo se habilita para automatismos en estado <i>"PausedSchedule"</i> o <i>"Stopped"</i>.</li>							
                      <li><b>Ejecutar:</b> Lanza una ejecuci√≥n √∫nica e inmediata de los automatismos seleccionados. Solo se habilita para automatismos en estado <i>"PausedSchedule"</i> o <i>"Stopped"</i>.</li>							
                      <li><b>Parar:</b> Detiene la programaci√≥n de los automatismos seleccionados. Solo se habilita para automatismos en estado <i>"Scheduled"</i> o <i>"Ready"</i>.</li>							
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
          
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Gesti√≥n de Journeys</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control para visualizar, filtrar y ejecutar acciones sobre m√∫ltiples journeys a la vez.</p>
                <ul>
                  <li>Al entrar por primera vez, se recuperar√°n y cargar√°n todos los journeys de la instancia</li>
                  <li>Es posible filtrar por <b>Nombre</b>, <b>Tipo</b>, <b>Estado</b> y <b>Data Extension</b> de los automatismos</li>
                  <li>La tabla muestra la informaci√≥n principal del Journey, donde se encuentra y que Data Extension se encuentra en su entrada.</li>
                  <li><b>Lanzar acciones.</b> En funcion de la acci√≥n que se quiera realizar, se podr√° seleccionar uno o varios journeys</b>.						
                    <ul style="margin-top: 10px;">							
                      <li><b>Refrescar:</b> Refresca el listado completo de automatismos. Esto se hace autom√°ticamente al realizar cualquier acci√≥n.</li>
                      <li><b>Comunicaciones:</b> Recupera todas las comunicaciones de los Journeys seleccionados. Lo que se muestra es el nombre de la actividad en el Journey por lo que si se ha cambiado, no coincidir√° con el contenido.</li>							
                      <li><b>Dibujar:</b> Permite crear una versi√≥n de texto del Journey de cara a la documentaci√≥n. Es necesario haber recuperado las comunicaciones previamente, lo cual marca el Journey como Descargado</li>		
                      <li><b>Copiar:</b> Permite clonar un Journey, con toda su estructura y clona la Data Extension de entrada en la misma carpeta donde se encontrar√° la anterior. Por ahora solo para los de tipo <b>"EmailAudience"</b>.</li>			
                      <li><b>Parar:</b> Permite parar varios Journeys a la vez</li>		
                      <li><b>Parar:</b> Permite borrar varios Journeys a la vez, si son de Subtipo Quicksend</li>							
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
          
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Buscador de Data Extensions</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control buscar rutas de Data Extensions.</p>
                <ul>
                  <li>Selecciona por qu√© quieres buscar: Nombre o External Key</li>
                  <li>No es necesario indicar el nombre completo, se mostrar√°n las rutas de todas las Data Extension que contengan el texto indicado</li>
                  <li>Al pulsar en <b>Buscar</b>, se mostrar√°n las rutas en la tabla inferior</li>					
                </ul>
              </div>
            </div>
          </li>

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Buscador de Origen de Datos</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control para buscar qu√© actividades rellenan los datos de una Data Extension (Queries e Imports).</p>
                <ul>
                  <li>Indica el nombre exacto de la Data Extension y pulsa en <b>Buscar Or√≠genes</b>.</li>
                  <li>Se mostrar√°n las actividades, el tipo y, si se encuentran dentro de una automatismo, en qu√© paso.</li>				
                </ul>
              </div>
            </div>
          </li>
          
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Buscador de Clientes</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control para buscar clientes y su informaci√≥n relacionada.</p>
                <ul>
                  <li>Pon el valor por el que quieres buscar. Puede ser un identificador o el mail.</li>
                  <li>Pulsa en <b>Buscar Cliente</b> para empezar la b√∫squeda.</li>
                  <li>Se realizar√° una b√∫squeda por Subscriber y si no se encuentra se buscara por Contacto.</li>
                  <li>Si se ha encontrado un suscriptor, los botones <b>DEs</b> y <b>Journeys</b> estar√°n activos</b>.
                  <li>Si se ha encontrado un contacto, el bot√≥n <b>Journeys</b> estar√° activo</b>.					
                    <ul style="margin-top: 10px;">							
                      <li><b>DEs:</b> Buscar√° lo que se haya indicado en el formulario en todas las DEs configuradas a nivel de Configuraci√≥n de APIs del cliente al que se ha conectado. Se muestran todos los campos de la tabla</li>
                      <li><b>Journeys:</b> Buscar√° lo que se haya indicado en el formulario en todos los Journeys. Si se encuentra en ese momento en alguno, lo mostrar√° en un tabla</li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
          
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Buscador de Texto en Queries</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control para buscar Queries que contengan el texto indicado en el buscado.</p>
                <ul>
                  <li>Pon el valor por el que quieres buscar. Puede ser un identificador o el mail.</li>
                  <li>Pulsa en <b>Buscar en Queries</b> para empezar la b√∫squeda.</li>
                  <li>La tabla muestra el nombre de las queries encontradas y en qu√© automatismo y paso se encuentran, si es que est√° en alguno.</li>
                  <li>La columna de Query Text se puede ocultar/mostrar con la casilla del formulario.</li>					
                </ul>
              </div>
            </div>
          </li>

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
            <span>Clonador Masivo de Queries</span>
            </div>
            <div class="docu-accordion-content">
            <div class="docu-list">
              <p>Esta herramienta te permite clonar m√∫ltiples Query Activities y sus Data Extensions de destino entre carpetas.</p>
              <ol>
              <li><b>Paso 1: Configuraci√≥n de Carpetas</b>
                <ul>
                  <li>Ve a <b>Funcionalidades ‚Üí Clonador de Queries</b>.</li>
                  <li>Introduce el nombre (o parte del nombre) de tres carpetas: la de origen de las Queries, la de destino de las Queries clonadas y la de destino de las DEs clonadas.</li>
                  <li>Pulsa <b>"Buscar Carpetas"</b>. Se mostrar√°n tablas con las posibles rutas encontradas.</li>
                  <li>Selecciona <b>una ruta de cada una de las tres tablas</b>. El bot√≥n <b>"Continuar"</b> se habilitar√°.</li>
                </ul>
              </li>
              <li><b>Paso 2: Selecci√≥n y Clonaci√≥n</b>
                <ul>
                  <li>Ver√°s una lista de todas las Queries de la carpeta de origen.</li>
                  <li>Usa las casillas de verificaci√≥n para seleccionar las que quieres clonar.</li>
                  <li>Puedes modificar el nombre de las DEs y Queries que se van a crear. Si no, se crear√°n a√±adiendo el sufijo `_Copy.</li>
                  <li>Pulsa <b>"Clonar Seleccionadas"</b>. La aplicaci√≥n clonar√° cada query y su DE de destino a las carpetas que elegiste.</li>
                </ul>
              </li>
              </ol>
            </div>
            </div>
          </li>
          
          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Validador de Email</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Una herramienta sencilla para verificar la validez de una direcci√≥n de correo con los validadores que utiliza Marketing Cloud.</p>
                <ul>
                  <li>Ve a <b>Funcionalidades ‚Üí Validador de Email</b>.</li>
                  <li>Introduce la direcci√≥n de correo y pulsa <b>"Validar Email"</b>.</li>
                  <li>El resultado te indicar√° si el email es v√°lido seg√∫n las validaciones de sintaxis, registros MX y List Detective de Marketing Cloud.</li>
                </ul>
              </div>
            </div>
          </li>

          <li class="docu-accordion-item">
            <div class="docu-accordion-header">
              <span>Gesti√≥n de Cloud Pages</span>
            </div>
            <div class="docu-accordion-content">
              <div class="docu-list">
                <p>Panel de control para visualizar y filtrar Cloud Pages.</p>
                <ul>
                  <li>Ve a <b>Funcionalidades ‚Üí Gesti√≥n de Cloud Pages</b>.</li>
                  <li>Se cargar√° la tabla con todas las Cloud Pages de la instancia.</li>
                  <li><b>Importante:</b> no es posible recuperar el identificador real (el que se utiliza en CloudPageURL()) porque ninguna API lo devuelve. ü§∑üèª</li>
                </ul>
              </div>
            </div>
          </li>

          </ol>
        </div>

        <!-- Pesta√±a: Errores Comunes -->
        <div id="errores-comunes" class="tab-content">
          <ul class="docu-list">
            <li>
              <div class="docu-item-header">
                <span class="docu-icon warning">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 9v4" /><path d="M10.36 15.64a2 2 0 1 1 3.28 0" /><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z" /></svg>
                </span>
                <strong>Error de autenticaci√≥n</strong>
              </div>
              <p>Si se ha creado la aplicaci√≥n en MC, se ha configurado el usuario en Marketing Cloud API Helper y luego se cambian los permisos en la aplicaci√≥n de MC, lo mejor es deslogearse y volverse a logear para que recupere el token con los permisos correctos.</p>
            </li>
            <li>
              <div class="docu-item-header">
                <span class="docu-icon warning">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 9v4" /><path d="M10.36 15.64a2 2 0 1 1 3.28 0" /><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z" /></svg>
                </span>
                <strong>La DE se crea en la carpeta ra√≠z</strong>
              </div>
              <p>Para crear una DE en una carpeta espec√≠fica, debes usar su <b>ID num√©rico</b>, no su nombre. Lo mismo ocurre para documentar las Data Extensions de una carpeta</p>
            </li>
          </ul>
        </div>
        
        <!-- Pesta√±a: Comentarios Adicionales -->
        <div id="comentarios-adicionales" class="tab-content">
          <ul class="docu-list">            
            <li>
              <div class="docu-item-header">
                <span class="docu-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 12l5 5l10 -10" /><path d="M2 12l5 5m5 -5l5 -5" /></svg>
                </span>
                <strong>"Crear/Actualizar campos" es un "upsert"</strong>
              </div>
              <p>Esta acci√≥n actualiza campos que ya existen o crea los que son nuevos, sin borrar los que no est√°n en la tabla.</p>
            </li>
            <li>
              <div class="docu-item-header">
                <span class="docu-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-decimal" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 15h-5a2 2 0 1 0 0 4h5" /><path d="M12 11v8" /><path d="M8 10h.01" /></svg>
                </span>
                <strong>Longitud en campos Decimales</strong>
              </div>
              <p>Para campos de tipo Decimal, usa el formato "total_d√≠gitos,n√∫mero_decimales", por ejemplo, <code>18,2</code>.</p>
            </li>
          </ul>
        </div>
      </div>
    </div>

<!-- 8. SECCI√ìN: VALIDADOR DE EMAIL -->
<div id="email-validator-section" class="section config-section-container">
    <div class="section-header"><button class="back-button">‚Üê Atr√°s</button></div>
    <h2>Validador de Email</h2>
    <div class="config-block">
        <h3>Par√°metros de Validaci√≥n</h3>
        <div class="form-group">
            <label for="emailToValidate">Email a validar:</label>
            <input type="text" id="emailToValidate" placeholder="Introduce la direcci√≥n de email">
        </div>
        <div class="header-actions" style="justify-content: center; margin-top: 20px;">
            <button id="validateEmailBtn" class="action-button">Validar Email</button>
        </div>
    </div>
    <div class="config-block">
        <h3>Resultado de la Validaci√≥n</h3>
        <pre id="email-validation-results">El resultado aparecer√° aqu√≠.</pre>
    </div>
</div>

<!-- 5. SECCI√ìN: CAMPOS DE LA DATA EXTENSION -->
<div id="campos-section" class="section">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>
        <div class="header-actions">
            <button id="importFieldsBtn" class="action-button">Importar</button>                
            <button id="createFieldsBtn" class="action-button activate-btn">Crear/Actualizar Campos</button>
            <button id="createDummyFieldsBtn" class="action-button">Campos de Ejemplo</button>                
            <button id="clearFieldsBtn" class="action-button delete-btn">Limpiar Tabla</button>
        </div>
    </div>
    <h2>Campos de la Data Extension</h2>
    <div class="table-container">
        <table id="myTable" class="editable-row-table">
        <thead>
            <tr><th>Campo MC</th><th>Tipo Campo</th><th>Longitud</th><th>Default</th><th>PK</th><th>Requerido</th></tr>
        </thead>
        <tbody></tbody>
        </table>
        <!-- Botones para mover filas seleccionadas -->
        <div class="control-buttons">
        <button id="addFieldBtn" class="action-button">A√±adir Fila</button>
        <button id="moveUp" title="Mover fila seleccionada hacia arriba">‚ñ≤</button>
        <button id="moveDown" title="Mover fila seleccionada hacia abajo">‚ñº</button>
        </div>
    </div>
</div>

<!-- 6. SECCI√ìN: GESTI√ìN DE CAMPOS (Recuperar/Borrar) -->
<div id="configuracion-campos-section" class="section config-section-container">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>
        <div class="header-actions">
            <button id="getFields" class="action-button">Recuperar Campos</button>
            <button id="documentDEsBtn" class="action-button">Documentar Data Extensions</button>
            <button id="deleteField" class="action-button delete-btn">Borrar Campo</button>
        </div>
    </div>
    <h2>Gesti√≥n de Campos de Data Extension</h2>
    <div class="config-block">
        <h3>Par√°metros para recuperaci√≥n de 1 DE, Actualizaci√≥n de tabla de campos y Borrado</h3>
        <p class="info-text" style="text-align: left; margin: 0 0 15px;">
            Introduce la External Key de la DE sobre la que quieres operar y pulsa en <em>Recuperar Campos</em>.  Estos se rellenar√°n en la picklist y en la secci√≥n <em>Campos</em>.
        </p>
        <div class="form-group">
            <label for="recExternalKey">External Key de la DE</label>
            <input type="text" id="recExternalKey">
        </div>
        <div class="form-group">
            <label for="targetFieldSelect">Campo a eliminar</label>
            <select id="targetFieldSelect" disabled><option value="">-- Pulsa "Recuperar Campos" --</option></select>
        </div>
    </div>
    <div class="config-block">
        <h3>Par√°metros para generaci√≥n de CSV con las DEs y sus campos </h3>
        <p class="info-text" style="text-align: left; margin: 0 0 15px;">
            Introduce un identificador de carpeta y pulsa en <em>Documentar Data Extensions</em>
        </p>
        <div class="form-group">
            <label for="recCategoryId">Identificador de carpeta</label>
            <input type="text" id="recCategoryId">
        </div>
    </div>
</div>

 <!-- 9. SECCI√ìN: BUSCADORES -->
<div id="buscadores-section" class="section">
    <div class="section-header"><button class="back-button">‚Üê Atr√°s</button></div>
    <h2>Buscadores</h2>
    <!-- Contenedor de pesta√±as para los diferentes tipos de b√∫squeda -->
    <div class="tabs-container">
    <div class="tab-buttons">
        <button class="tab-button active" data-tab="busqueda-de-tab">Data Extensions</button>
        <button class="tab-button" data-tab="origenes-tab">Origen de datos</button>
        <button class="tab-button" data-tab="clientes-tab">Clientes</button>
        <button class="tab-button" data-tab="queries-tab">Texto en Queries</button>
    </div>

    <!-- Pesta√±a: B√∫squeda de Data Extension -->
    <div id="busqueda-de-tab" class="tab-content active config-section-container">
        <div class="config-block">
            <h3>Par√°metros de B√∫squeda</h3>
            <div class="form-group">
                <label for="deSearchProperty">Buscar por:</label>
                <select id="deSearchProperty">
                    <option value="Name">Nombre</option>
                    <option value="CustomerKey">External Key</option>
                </select>
            </div>
            <div class="form-group">
                <label for="deSearchValue">Valor:</label>
                <input type="text" id="deSearchValue" placeholder="Ingresa el valor de b√∫squeda" maxlength="128">
            </div>
            <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                <button id="searchDEBtn" class="action-button">Buscar</button>
            </div>
        </div>
            <div class="config-block" style="flex-grow: 1;">
                <h3>Resultados</h3>
                <div class="table-container">
                    <table id="de-search-results-table">
                        <thead>
                            <tr>
                                <th>Nombre Data Extension</th>
                                <th>Ruta de Carpeta</th>
                            </tr>
                        </thead>
                        <tbody id="de-search-results-tbody"></tbody>
                    </table>
                </div>
            </div>
    </div>

    <!-- Pesta√±a: Buscador de Or√≠genes de Datos -->
    <div id="origenes-tab" class="tab-content config-section-container">
        <div class="config-block">
            <h3>Par√°metros de B√∫squeda</h3>
            <div class="form-group">
                <label for="deNameToFind">Nombre de la Data Extension:</label>
                <input type="text" id="deNameToFind" placeholder="Introduce el nombre exacto de la DE">
            </div>
            <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                <button id="findDataSourcesBtn" class="action-button">Buscar Or√≠genes</button>
            </div>
        </div>
        <div class="config-block" style="flex-grow: 1;">
            <h3>Actividades Encontradas</h3>
            <div class="table-container">
                <table id="data-sources-table">
                    <thead>
                        <tr>
                            <th>Actividad</th><th>Tipo</th><th>Automatizaci√≥n</th>
                            <th>Paso</th><th>Acci√≥n</th><th>Descripci√≥n / Query</th>
                        </tr>
                    </thead>
                    <tbody id="data-sources-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Pesta√±a: Buscador de Clientes (Suscriptores) -->
    <div id="clientes-tab" class="tab-content config-section-container">
        <div class="config-block">
            <h3>Par√°metros de B√∫squeda</h3>
            <div class="form-group">
                <label for="customerSearchValue">Buscar por Subscriber Key o Email:</label>
                <input type="text" id="customerSearchValue" placeholder="Ingresa el valor a buscar">
            </div>
            <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                <button id="searchCustomerBtn" class="action-button">Buscar Cliente</button>
            </div>
        </div>
        <!-- Bloque de Resultados de la B√∫squeda -->
        <div class="config-block" style="flex-grow: 1;">
            <div class="config-block-header">
                <h3>Resultados</h3>
                <div class="header-actions">
                    <button id="getDEsBtn" class="action-button" disabled>DEs</button>
                    <button id="getCustomerJourneysBtn" class="action-button" disabled>Journeys</button>
                </div>
            </div>
            <div class="table-container">
                <table id="customer-search-table">
                    <thead>
                        <tr>
                            <th>Subscriber Key</th><th>Email</th><th>Estado</th>
                            <th>Fecha Creaci√≥n</th><th>Fecha Baja</th><th>Es Suscriptor</th>
                        </tr>
                    </thead>
                    <tbody id="customer-search-tbody"></tbody>
                </table>
            </div>
        </div>
        <!-- Bloque de Resultados de Journeys (oculto por defecto) -->
        <div id="customer-journeys-results-block" class="config-block hidden">
            <h3>Journeys del Cliente Seleccionado</h3>
            <div class="table-container">
                <table id="customer-journeys-table">
                    <thead>
                        <tr>
                            <th>Nombre del Journey</th><th>ID</th><th>Definition Key</th>
                            <th>Versi√≥n</th><th>Fecha Creaci√≥n</th><th>Fecha Modificaci√≥n</th>
                        </tr>
                    </thead>
                    <tbody id="customer-journeys-tbody"></tbody>
                </table>
            </div>
        </div>
        <!-- Bloque de Resultados de Env√≠os (oculto por defecto) -->
        <div id="customer-sends-results-block" class="config-block hidden">
            <h3>Resultados de B√∫squeda en Data Extensions</h3>
            <div id="sends-results-container">
                <!-- Los resultados se inyectar√°n aqu√≠ din√°micamente -->
            </div>
        </div>
    </div>

    <!-- Pesta√±a: Buscador de Texto en Queries -->
    <div id="queries-tab" class="tab-content config-section-container">
        <div class="config-block">
            <h3>Par√°metros de B√∫squeda</h3>
            <div class="form-group">
                <label for="querySearchText">Texto a buscar en la Query:</label>
                <input type="text" id="querySearchText" placeholder="Ej: _Subscribers o Nombre_DE">
            </div>
            <div class="form-group checkbox-group" style="justify-content: flex-start;">
                <label for="showQueryTextCheckbox">Mostrar Query Text:</label>
                <input type="checkbox" id="showQueryTextCheckbox" checked>
            </div>
            <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                <button id="searchQueriesByTextBtn" class="action-button">Buscar en Queries</button>
            </div>
        </div>
        <div class="config-block" style="flex-grow: 1;">
            <h3>Queries Encontradas</h3>
            <div class="table-container">
                <table id="query-search-results-table">
                    <thead>
                        <tr>
                            <th>Nombre de la Query</th><th>Automatizaci√≥n</th>
                            <th>Paso</th><th>Query Text</th>
                        </tr>
                    </thead>
                    <tbody id="query-search-results-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>
    </div>
</div>

<!-- 11. SECCI√ìN: GESTI√ìN DE JOURNEYS -->
<div id="gestion-journeys-section" class="section">
    <div class="section-header">
        <button class="back-button">‚Üê Atr√°s</button>  
        <div class="header-actions">
            <button id="refreshJourneysTableBtn" class="action-button">Refrescar</button>
            <button id="getCommunicationsBtn" class="action-button activate-btn" disabled>Comunicaciones</button>
            <button id="drawJourneyBtn" class="action-button" disabled>Dibujar</button>
            <button id="copyJourneyBtn" class="action-button" disabled>Copiar</button>
            <button id="stopJourneyBtn" class="action-button delete-btn" disabled>Parar</button>
            <button id="deleteJourneyBtn" class="action-button delete-btn-darker" disabled>Borrar</button>
        </div>          
    </div>
    <h2>Gesti√≥n de Journeys</h2>
    <!-- Filtros para la tabla de journeys -->
    <div class="header-filters">
        <input type="text" id="journeyNameFilter" class="filter-input" placeholder="Buscar por nombre...">
        <select id="journeyTypeFilter" class="filter-input">
            <option value="">Todos los tipos</option>
            <!-- Opciones se cargar√°n din√°micamente -->
        </select>
        <select id="journeySubtypeFilter" class="filter-input">
            <option value="">Todos los subtipos</option>
            <!-- Opciones se cargar√°n din√°micamente -->
        </select>
        <select id="journeyStatusFilter" class="filter-input">
            <option value="">Todos los estados</option>
            <!-- Opciones se cargar√°n din√°micamente -->
        </select>
        <input type="text" id="journeyDEFilter" class="filter-input" placeholder="Buscar por Data Extension...">
    </div>
    <div class="table-container">
        <table id="journeys-table">
        <thead>
            <tr>
            <th class="sortable-header" data-sort-by="name">Nombre Journey</th>
            <th class="sortable-header" data-sort-by="version">Versi√≥n</th>
            <th class="sortable-header" data-sort-by="createdDate">Fecha creaci√≥n</th>
            <th class="sortable-header" data-sort-by="modifiedDate">Fecha modificaci√≥n</th>
            <th class="sortable-header" data-sort-by="eventType">Tipo</th>
            <th class="sortable-header" data-sort-by="definitionType">Subtipo</th>
            <th class="sortable-header" data-sort-by="status">Estado</th>
            <th class="sortable-header" data-sort-by="location">Ubicaci√≥n</th>
            <th class="sortable-header" data-sort-by="dataExtensionName">Data Extension</th>
            <th class="sortable-header" data-sort-by="hasCommunications">Descargado</th>
            <th class="sortable-header" data-sort-by="emails">Emails</th>
            <th class="sortable-header" data-sort-by="sms">SMSs</th>
            <th class="sortable-header" data-sort-by="pushes">Pushes</th>
            </tr>
        </thead>
        <tbody id="journeys-tbody"></tbody>
        </table>
    </div>
        <div id="pagination-journeys" class="pagination-controls">
        <button id="prevPageBtnJourneys" class="action-button pagination-arrow">&laquo;</button>
        <input type="number" id="pageInputJourneys" class="filter-input page-input" min="1">
        <span id="totalPagesJourneys">/ 1</span>
        <button id="nextPageBtnJourneys" class="action-button pagination-arrow">&raquo;</button>
    </div>
</div>

<!-- 1. PANTALLA DE BIENVENIDA (MEN√ö PRINCIPAL) -->
<div id="main-menu" class="main-menu-container" style="display: flex;">
    <div class="menu-group">
    <h3>Panel Principal</h3>
    <div class="menu-buttons-container">
        <img src="assets/welcome2.gif" alt="Animaci√≥n de bienvenida" class="welcome-gif">
        <p class="info-text">
        Para empezar, configura un cliente en "Configuraci√≥n de APIs". Al pulsar en login (o seleccion√°ndolo si ya estaba guardado) se iniciar√° el proceso de autenticaci√≥n.
        </p>
        
    </div>
    </div>
</div>

<!-- 12. SECCI√ìN: CLONADOR DE QUERIES (CORREGIDO) -->
<div id="clonador-queries-section" class="section config-section-container">
    <!-- ========================================================== -->
    <!-- PASO 1: CONFIGURACI√ìN DE CARPETAS                        -->
    <!-- ========================================================== -->
    <div id="queries-cloner-step1" class="cloner-step-container">
        <div class="section-header">
            <!-- CORRECCI√ìN: A√±adida la clase "action-button" -->
            <button class="action-button back-button">‚Üê Atr√°s</button>
        </div>
        <h2>Clonador de Queries - Paso 1: Configuraci√≥n</h2>
        
        <!-- Bloque del Formulario -->
        <div class="config-block">
            <h3>Carpetas de Origen y Destino</h3>
            <div class="form-group">
                <label for="querySourceFolderName">Nombre de carpeta con Queries a clonar</label>
                <input type="text" id="querySourceFolderName" placeholder="Introduce un nombre o parte de √©l">
            </div>
            <div class="form-group">
                <label for="queryTargetFolderName">Nombre de carpeta donde guardar Queries clonadas</label>
                <input type="text" id="queryTargetFolderName" placeholder="Introduce un nombre o parte de √©l">
            </div>
            <div class="form-group">
                <label for="deTargetFolderName">Nombre de carpeta donde guardar DEs clonadas</label>
                <input type="text" id="deTargetFolderName" placeholder="Introduce un nombre o parte de √©l">
            </div>
            <div class="header-actions" style="justify-content: center; margin-top: 20px;">
                <button id="queryClonerSearchFoldersBtn" class="action-button" disabled>Buscar Carpetas</button>
            </div>
        </div>

        <!-- Bloque de Resultados de B√∫squeda -->
        <div id="query-cloner-folder-results" class="config-block hidden">
            <div class="config-block-header">
                <h3>Resultados de B√∫squeda</h3>
                <div class="header-actions">
                    <button id="queryClonerContinueBtn" class="action-button" disabled>Continuar ‚Üí</button>
                </div>
            </div>
            <div class="folder-results-grid">
                <div class="folder-column">
                    <h4>Posibles carpetas de Queries a clonar</h4>
                    <div class="table-container">
                        <table id="query-source-folders-table" class="folder-results-table">
                            <thead><tr><th>Ruta de Carpeta</th></tr></thead>
                            <tbody id="query-source-folders-tbody"></tbody>
                        </table>
                    </div>
                </div>
                <div class="folder-column">
                    <h4>Posibles carpetas para Queries clonadas</h4>
                    <div class="table-container">
                        <table id="query-target-folders-table" class="folder-results-table">
                            <thead><tr><th>Ruta de Carpeta</th></tr></thead>
                            <tbody id="query-target-folders-tbody"></tbody>
                        </table>
                    </div>
                </div>
                <div class="folder-column">
                    <h4>Posibles carpetas para DEs clonadas</h4>
                    <div class="table-container">
                        <table id="de-target-folders-table" class="folder-results-table">
                            <thead><tr><th>Ruta de Carpeta</th></tr></thead>
                            <tbody id="de-target-folders-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================================== -->
    <!-- PASO 2: SELECCI√ìN DE QUERIES (Oculto por defecto)        -->
    <!-- ========================================================== -->
    <div id="queries-cloner-step2" class="cloner-step-container" style="display: none;">
            <div class="section-header">
            <!-- CORRECCI√ìN: A√±adida la clase "action-button" -->
            <button id="queryClonerBackBtn" class="action-button">‚Üê Atr√°s</button>
        </div>
        <h2>Clonador de Queries - Paso 2: Selecci√≥n</h2>
        
        <div class="config-block" style="flex-grow: 1; display: flex; flex-direction: column;">
            <div class="config-block-header">
                <h3>Selecciona las Queries a clonar</h3>
                <div class="header-actions">
                    <button id="queryClonerCloneBtn" class="action-button activate-btn" disabled>Clonar Seleccionadas</button>
                </div>
            </div>
            <div class="table-container" style="flex-grow: 1;">
                <table id="query-selection-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllQueriesCheckbox" title="Seleccionar Todas"></th>
                            <th>Query Origen</th>
                            <th>DE Origen</th>
                            <th>Query Destino</th>
                            <th>DE Destino</th>
                        </tr>
                    </thead>
                    <tbody id="query-selection-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>


  </main> 

  <!-- ========================================================== -->
  <!-- BARRA LATERAL DERECHA (LOG) -->
  <!-- ========================================================== -->
  <aside id="log-sidebar">
    <div class="log-header">
      <h2>Log de Eventos</h2>
      <button id="toggleLogBtn" title="Colapsar/Expandir Log"></button>
    </div>
    <div id="log-message-block" class="log-block">
      <h4>Mensajes</h4>
      <pre><code id="log-messages">Esperando acciones...</code></pre>
    </div>
    <div id="log-request-block" class="log-block">
      <h4>Llamada API</h4>
      <pre><code id="log-request"></code></pre>
    </div>
    <div id="log-response-block" class="log-block">
      <h4>Respuesta API</h4>
      <pre><code id="log-response"></code></pre>
    </div>
  </aside>

</div> <!-- FIN .app-container -->

<!-- ========================================================== -->
<!-- START: MODALES GLOBALES (parte inferior) -->
<!-- ========================================================== -->
<div id="import-modal" class="modal-overlay">
    <div class="modal-content">
        <h3>Importar Campos desde Portapapeles</h3>
        <p>Pega aqu√≠ los datos. Las columnas deben ser: <b>Nombre</b>, <b>Tipo</b> y <b>Longitud</b> (opcional).</p>
        <div class="delimiter-selector">
            <label for="delimiter-select">Separador:</label>
            <select id="delimiter-select">
                <option value="tab" selected>Tabulador (Excel)</option>
                <option value="comma">Coma (,)</option>
                <option value="semicolon">Punto y coma (;)</option>
                <option value="other">Otro...</option>
            </select>
            <input type="text" id="custom-delimiter-input" class="hidden" maxlength="1" placeholder="|">
        </div>
        <textarea id="paste-data-area" rows="10" placeholder="Ciudad	Text	50&#10;Email	EmailAddress	254"></textarea>
        <div class="modal-actions">
            <button id="process-paste-btn" class="action-button">A√±adir Campos</button>
            <button id="cancel-paste-btn" class="action-button delete-btn">Cancelar</button>
        </div>
    </div>
</div>
<div id="journey-flow-modal" class="modal-overlay">
    <div class="modal-content modal-lg">
        <h3>Flujo del Journey</h3>
        <div class="journey-flow-container">
            <pre id="journey-flow-content">Cargando flujo...</pre>
        </div>
        <div class="modal-actions">
            <button id="copyFlowBtn" class="action-button">Copiar</button>
            <button id="close-flow-btn" class="action-button">Cerrar</button>
        </div>
    </div>
</div>
<div id="custom-alert-modal" class="modal-overlay">
    <div class="modal-content">
        <h3>Aviso</h3>
        <p id="custom-alert-message" style="line-height: 1.6;"></p>
        <div class="modal-actions" style="margin-top: 20px;">
            <button id="custom-alert-close-btn" class="action-button">Aceptar</button>
        </div>
    </div>
</div>
<div id="custom-confirm-modal" class="modal-overlay">
    <div class="modal-content">
        <h3>Confirmaci√≥n Requerida</h3>
        <p id="custom-confirm-message" style="line-height: 1.6;"></p>
        <div class="modal-actions" style="margin-top: 20px;">
            <button id="custom-confirm-cancel-btn" class="action-button delete-btn">Cancelar</button>
            <button id="custom-confirm-ok-btn" class="action-button activate-btn">Confirmar</button>
        </div>
    </div>
</div>
 
<script type="module" src="app.js"></script>
</body>
</html>